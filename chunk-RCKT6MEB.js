import{a as Se,e as Ce,f as we}from"./chunk-HRFADIH7.js";import{a as fe}from"./chunk-T6UF27DB.js";import{M as _e,_ as he,da as ge,ea as xe}from"./chunk-K7LFHNPM.js";import{h as E,i as ue}from"./chunk-FELGKWXU.js";import{$ as G,Db as x,E as q,Fa as Y,Hb as M,Ic as T,Jc as N,Ka as j,Kb as re,La as B,Lb as se,Mb as l,Nb as c,Ob as ae,Rb as ce,S as K,Sb as y,Vb as C,Xb as u,a as s,b as v,ca as J,cb as Z,dc as le,ec as me,f as W,fb as a,fc as F,hc as d,ia as k,ib as ee,ic as g,kc as V,na as L,oc as pe,pa as X,pb as te,pc as D,qb as ie,rb as ne,rc as de,sb as oe,sc as m,tc as p,v as z,ya as _,yb as w,za as h}from"./chunk-BNAA7LUV.js";var I=(()=>{let e=class e{constructor(){this.templateRef=k(ee)}};e.\u0275fac=function(n){return new(n||e)},e.\u0275dir=X({type:e,selectors:[["","listItemTemplate",""]],standalone:!0});let t=e;return t})();var De=["viewport"],Ee=t=>({$implicit:t});function Pe(t,e){if(t&1){let o=y();l(0,"li",4),C("click",function(){let n=_(o).$implicit,r=u();return h(r.selectItem(n))})("keyup.enter",function(){let n=_(o).$implicit,r=u();return h(r.selectItem(n))})("keydown.arrowDown",function(){let n=_(o).index,r=u();return h(r.changeFocus(n+1))})("keydown.arrowUp",function(){let n=_(o).index,r=u();return h(r.changeFocus(n-1))}),ce(1,5),c()}if(t&2){let o=e.$implicit,i=e.index,n=u();x("id",i)("ngClass",n.selectedItem===o?"card__selected":"card")("tabindex",n.focusableIndex===i?0:-1),a(),x("ngTemplateOutlet",n.listItemTemplateRef().templateRef)("ngTemplateOutletContext",de(5,Ee,o))}}var be=(()=>{let e=class e{constructor(){this.focusableIndex=0,this.data=B([]),this.itemHeight=B(0),this.fetchMore=j(),this.selected=j(),this.listItemTemplateRef=oe(I),this.viewport=ne.required("viewport")}ngAfterViewInit(){this.subscription=this.viewport().elementScrolled().pipe(z(()=>this.viewport().measureScrollOffset("bottom")),K(),q(([i,n])=>n<i&&n<this.itemHeight()*2),G(50)).subscribe(()=>{this.fetchMore.emit()})}selectItem(i){this.selectedItem=i,this.selected.emit(i)}changeFocus(i){let n=document.getElementById(i.toString());n&&(n.focus(),this.focusableIndex=i)}trackBy(i){return i}ngOnDestroy(){this.subscription?.unsubscribe()}};e.\u0275fac=function(n){return new(n||e)},e.\u0275cmp=L({type:e,selectors:[["psa-list"]],contentQueries:function(n,r,b){n&1&&le(b,r.listItemTemplateRef,I,5),n&2&&F()},viewQuery:function(n,r){n&1&&me(r.viewport,De,5),n&2&&F()},inputs:{data:[1,"data"],itemHeight:[1,"itemHeight"]},outputs:{fetchMore:"fetchMore",selected:"selected"},standalone:!0,features:[D],decls:4,vars:3,consts:[["viewport",""],[1,"list",3,"itemSize"],["role","listbox"],["role","option","matRipple","",3,"id","ngClass","tabindex","click","keyup.enter","keydown.arrowDown","keydown.arrowUp",4,"cdkVirtualFor","cdkVirtualForOf","cdkVirtualForTrackBy"],["role","option","matRipple","",3,"click","keyup.enter","keydown.arrowDown","keydown.arrowUp","id","ngClass","tabindex"],[3,"ngTemplateOutlet","ngTemplateOutletContext"]],template:function(n,r){n&1&&(l(0,"cdk-virtual-scroll-viewport",1,0)(2,"ul",2),w(3,Pe,2,7,"li",3),c()()),n&2&&(x("itemSize",r.itemHeight()),a(3),x("cdkVirtualForOf",r.data())("cdkVirtualForTrackBy",r.trackBy))},dependencies:[Ce,Se,we,E,ue,_e],styles:[".list[_ngcontent-%COMP%]{width:100%;height:100%;display:flex;flex-direction:column;gap:8px;scrollbar-width:thin}.card[_ngcontent-%COMP%], .card__selected[_ngcontent-%COMP%]{padding:32px;border-radius:4px;border-right:solid 1px rgba(255,255,255,.12);background-color:#282828;margin:8px;cursor:pointer}.card__selected[_ngcontent-%COMP%]{background-color:#343434}"],changeDetection:0});let t=e;return t})();var Oe=new WeakMap,f=Symbol("STATE_SOURCE");function P(t,...e){t[f].update(o=>e.reduce((i,n)=>s(s({},i),typeof n=="function"?n(i):n),o)),Fe(t)}function je(t){return t[f]()}function Be(t){return Oe.get(t[f][W])||[]}function Fe(t){let e=Be(t);for(let o of e){let i=N(()=>je(t));o(i)}}function ke(t){let e=N(()=>t());return Ne(e)?new Proxy(t,{get(o,i){return i in e?(te(o[i])||Object.defineProperty(o,i,{value:T(()=>o()[i]),configurable:!0}),ke(o[i])):o[i]}}):t}function Ne(t){return t?.constructor===Object}function ve(...t){let e=[...t],o=typeof e[0]=="function"?{}:e.shift(),i=e;return(()=>{class r{constructor(){let S=i.reduce((R,Ve)=>Ve(R),He()),{stateSignals:O,computedSignals:Re,methods:Le,hooks:Me}=S,U=s(s(s({},O),Re),Le);this[f]=o.protectedState===!1?S[f]:S[f].asReadonly();for(let R in U)this[R]=U[R];let{onInit:$,onDestroy:Q}=Me;$&&$(),Q&&k(Y).onDestroy(Q)}static \u0275fac=function(O){return new(O||r)};static \u0275prov=J({token:r,factory:r.\u0275fac,providedIn:o.providedIn||null})}return r})()}function He(){return{[f]:ie({}),stateSignals:{},computedSignals:{},methods:{},hooks:{}}}function ye(t){return e=>{let o=t(s(s({},e.stateSignals),e.computedSignals));return Object.keys(o),v(s({},e),{computedSignals:s(s({},e.computedSignals),o)})}}function Te(t){return e=>{let o=t(s(s(s({[f]:e[f]},e.stateSignals),e.computedSignals),e.methods));return Object.keys(o),v(s({},e),{methods:s(s({},e.methods),o)})}}function Ie(t){return e=>{let o=typeof t=="function"?t():t,i=Object.keys(o);e[f].update(r=>s(s({},r),o));let n=i.reduce((r,b)=>{let S=T(()=>e[f]()[b]);return v(s({},r),{[b]:ke(S)})},{});return v(s({},e),{stateSignals:s(s({},e.stateSignals),n)})}}var Ae={rooms:{total:0,data:[]},selectedRoom:{roomNumber:0,booked:!1}},A=ve(Ie(Ae),ye(({rooms:t})=>({bookedRooms:T(()=>t().data.filter(e=>e.booked))})),Te(t=>({setRooms(e){P(t,{rooms:e})},patchRooms(e){P(t,o=>({rooms:{total:1e4,data:[...o.rooms.data,...e]}}))},patchSelectedRoom(e){P(t,{selectedRoom:e})}})));var Ue=(t,e)=>e.roomNumber;function $e(t,e){t&1&&(l(0,"p",13),d(1),m(2,"translate"),c()),t&2&&(a(),g(p(2,1,"LIST.reservation")))}function Qe(t,e){if(t&1&&(l(0,"span",11)(1,"p",12),d(2),m(3,"translate"),c(),w(4,$e,3,3,"p",13),c()),t&2){let o=e.$implicit;a(),x("ngClass",o.roomNumber===666?"hell":""),a(),V("",p(3,4,"LIST.room-number")," ",o.roomNumber,""),a(2),M(o.booked?4:-1)}}function We(t,e){if(t&1){let o=y();l(0,"button",15),C("click",function(){_(o);let n=u(2);return h(n.cancel())}),d(1),m(2,"translate"),c(),l(3,"button",15),C("click",function(){_(o);let n=u(2);return h(n.book())}),d(4),m(5,"translate"),c()}t&2&&(a(),g(p(2,2,"LIST.cancel")),a(3),g(p(5,4,"LIST.reserve")))}function ze(t,e){if(t&1){let o=y();l(0,"button",15),C("click",function(){_(o);let n=u(2);return h(n.cancel())}),d(1),m(2,"translate"),c(),l(3,"button",15),C("click",function(){_(o);let n=u(2);return h(n.deleteReservation())}),d(4),m(5,"translate"),c()}t&2&&(a(),g(p(2,2,"LIST.cancel")),a(3),g(p(5,4,"LIST.delete-reservation")))}function qe(t,e){if(t&1&&(l(0,"p"),d(1),m(2,"translate"),c(),l(3,"span",14),w(4,We,6,6)(5,ze,6,6),c()),t&2){let o=u();a(),V("",p(2,3,"LIST.room-nr")," ",o.store.selectedRoom().roomNumber,""),a(3),M(o.store.rooms().data[o.store.selectedRoom().roomNumber-1].booked?5:4)}}function Ke(t,e){if(t&1&&(l(0,"p"),d(1),m(2,"translate"),c()),t&2){let o=e.$implicit;a(),V("",p(2,2,"LIST.room-nr")," ",o.roomNumber,"")}}var Mt=(()=>{let e=class e{constructor(){this.store=k(A),this.skip=0,this.allRooms=Array.from({length:1e4},(i,n)=>({roomNumber:n+1,booked:!1}))}ngOnInit(){this.getFirstRooms()}getFirstRooms(){this.skip=0;let i=this.allRooms.slice(this.skip,this.skip+50);this.store.setRooms({total:1e4,data:i})}fetchMoreRooms(){if(this.store.rooms().data.length===this.store.rooms().total)return;this.skip+=50;let i=this.allRooms.slice(this.skip,this.skip+50);this.store.patchRooms(i)}selectRoom(i){i&&this.store.patchSelectedRoom(i)}cancel(){this.store.patchSelectedRoom({roomNumber:0,booked:!1})}book(){let i=s({},this.store.rooms());i.data[this.store.selectedRoom().roomNumber-1].booked=!0,this.store.setRooms(i),this.cancel()}deleteReservation(){let i=s({},this.store.rooms());i.data[this.store.selectedRoom().roomNumber-1].booked=!1,this.store.setRooms(i),this.cancel()}};e.\u0275fac=function(n){return new(n||e)},e.\u0275cmp=L({type:e,selectors:[["psa-list-page"]],standalone:!0,features:[pe([A]),D],decls:26,vars:18,consts:[[1,"h-full"],[1,"text-2xl","mb-4"],[1,"flex","flex-col","gap-4"],[1,"divider"],[1,"ml-2",3,"innerHTML"],[1,"flex","flex-col","sm:flex-row","gap-8"],[1,"psa-list"],[3,"fetchMore","selected","data","itemHeight"],["listItemTemplate",""],[1,"flex","flex-col","gap-8","w-48"],[1,"mb-4"],[1,"flex","flex-row","justify-between","items-center"],[3,"ngClass"],[1,"booked"],[1,"flex","flex-row","gap-4"],["mat-button","",3,"click"]],template:function(n,r){n&1&&(l(0,"psa-card",0)(1,"h1",1),d(2),m(3,"translate"),c(),l(4,"div",2)(5,"p"),d(6),m(7,"translate"),c(),ae(8,"div",3)(9,"p",4),m(10,"translate"),l(11,"div",5)(12,"div",6)(13,"psa-list",7),C("fetchMore",function(){return r.fetchMoreRooms()})("selected",function(S){return r.selectRoom(S)}),w(14,Qe,5,6,"ng-template",8),c()(),l(15,"div",9)(16,"p"),d(17),m(18,"translate"),c(),w(19,qe,6,5),c(),l(20,"div")(21,"p",10),d(22),m(23,"translate"),c(),re(24,Ke,3,4,"p",null,Ue),c()()()()),n&2&&(a(2),g(p(3,8,"LIST.header")),a(4),g(p(7,10,"LIST.component-desc")),a(3),x("innerHTML",p(10,12,"LIST.hello"),Z),a(4),x("data",r.store.rooms().data)("itemHeight",88),a(4),g(p(18,14,"LIST.selected-room")),a(2),M(r.store.selectedRoom().roomNumber>0?19:-1),a(3),g(p(23,16,"LIST.your-reservations")),a(2),se(r.store.bookedRooms()))},dependencies:[fe,be,I,xe,ge,E,he],styles:[".psa-list[_ngcontent-%COMP%]{height:560px;width:300px}.hell[_ngcontent-%COMP%]{color:red}.divider[_ngcontent-%COMP%]{height:1px;background-color:#818181}.booked[_ngcontent-%COMP%]{font-size:12px;color:#0dd}"],changeDetection:0});let t=e;return t})();export{Mt as ListPageComponent};
