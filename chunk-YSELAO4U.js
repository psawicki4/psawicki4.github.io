import{b as oe,f as ne,g as re}from"./chunk-J3RKUDUN.js";import{a as I,b as ae,c as se,d as le,e as ce}from"./chunk-NE6Z4AGD.js";import{a as ie}from"./chunk-UHHT6VUL.js";import{M as Z,X as ee,Z as te}from"./chunk-43OKRYG5.js";import{h as y,i as Y}from"./chunk-FQPOG6N5.js";import{Bb as h,D as B,Fb as b,Fc as X,Ia as V,Ib as A,Ja as M,Jb as U,Kb as l,Lb as s,Mb as j,Pb as q,Qb as C,R as O,Tb as x,Vb as d,_ as D,a as L,ab as H,bc as G,cc as J,db as r,dc as P,fc as m,gb as $,gc as f,ha as k,ic as S,ma as v,mc as K,nc as T,oa as N,pb as Q,pc as W,qb as z,qc as c,rc as p,u as F,wa as u,wb as g,xa as _}from"./chunk-L6QZW2PC.js";var w=(()=>{let i=class i{constructor(){this.templateRef=k($)}};i.\u0275fac=function(e){return new(e||i)},i.\u0275dir=N({type:i,selectors:[["","listItemTemplate",""]],standalone:!0});let t=i;return t})();var ue=["viewport"],_e=t=>({$implicit:t});function fe(t,i){if(t&1){let n=C();l(0,"li",4),x("click",function(){let e=u(n).$implicit,a=d();return _(a.selectItem(e))})("keyup.enter",function(){let e=u(n).$implicit,a=d();return _(a.selectItem(e))})("keydown.arrowDown",function(){let e=u(n).index,a=d();return _(a.changeFocus(e+1))})("keydown.arrowUp",function(){let e=u(n).index,a=d();return _(a.changeFocus(e-1))}),q(1,5),s()}if(t&2){let n=i.$implicit,o=i.index,e=d();h("id",o)("ngClass",e.selectedItem===n?"card__selected":"card")("tabindex",e.focusableIndex===o?0:-1),r(),h("ngTemplateOutlet",e.listItemTemplateRef().templateRef)("ngTemplateOutletContext",W(5,_e,n))}}var me=(()=>{let i=class i{constructor(){this.focusableIndex=0,this.data=M([]),this.itemHeight=M(0),this.fetchMore=V(),this.selected=V(),this.listItemTemplateRef=z(w),this.viewport=Q.required("viewport")}ngAfterViewInit(){this.subscription=this.viewport().elementScrolled().pipe(F(()=>this.viewport().measureScrollOffset("bottom")),O(),B(([o,e])=>e<o&&e<this.itemHeight()*2),D(50)).subscribe(()=>{this.fetchMore.emit()})}selectItem(o){this.selectedItem=o,this.selected.emit(o)}changeFocus(o){let e=document.getElementById(o.toString());e&&(e.focus(),this.focusableIndex=o)}trackBy(o){return o}ngOnDestroy(){this.subscription?.unsubscribe()}};i.\u0275fac=function(e){return new(e||i)},i.\u0275cmp=v({type:i,selectors:[["psa-list"]],contentQueries:function(e,a,R){e&1&&G(R,a.listItemTemplateRef,w,5),e&2&&P()},viewQuery:function(e,a){e&1&&J(a.viewport,ue,5),e&2&&P()},inputs:{data:[1,"data"],itemHeight:[1,"itemHeight"]},outputs:{fetchMore:"fetchMore",selected:"selected"},standalone:!0,features:[T],decls:4,vars:3,consts:[["viewport",""],[1,"list",3,"itemSize"],["role","listbox"],["role","option","matRipple","",3,"id","ngClass","tabindex","click","keyup.enter","keydown.arrowDown","keydown.arrowUp",4,"cdkVirtualFor","cdkVirtualForOf","cdkVirtualForTrackBy"],["role","option","matRipple","",3,"click","keyup.enter","keydown.arrowDown","keydown.arrowUp","id","ngClass","tabindex"],[3,"ngTemplateOutlet","ngTemplateOutletContext"]],template:function(e,a){e&1&&(l(0,"cdk-virtual-scroll-viewport",1,0)(2,"ul",2),g(3,fe,2,7,"li",3),s()()),e&2&&(h("itemSize",a.itemHeight()),r(3),h("cdkVirtualForOf",a.data())("cdkVirtualForTrackBy",a.trackBy))},dependencies:[ne,oe,re,y,Y,Z],styles:[".list[_ngcontent-%COMP%]{width:100%;height:100%;display:flex;flex-direction:column;gap:8px;scrollbar-width:thin}.card[_ngcontent-%COMP%], .card__selected[_ngcontent-%COMP%]{padding:32px;border-radius:4px;border-right:solid 1px rgba(255,255,255,.12);background-color:#282828;margin:8px;cursor:pointer}.card__selected[_ngcontent-%COMP%]{background-color:#343434}"],changeDetection:0});let t=i;return t})();var he={rooms:{total:0,data:[]},selectedRoom:{roomNumber:0,booked:!1}},E=ae(ce(he),se(({rooms:t})=>({bookedRooms:X(()=>t().data.filter(i=>i.booked))})),le(t=>({setRooms(i){I(t,{rooms:i})},patchRooms(i){I(t,n=>({rooms:{total:1e4,data:[...n.rooms.data,...i]}}))},patchSelectedRoom(i){I(t,{selectedRoom:i})}})));var xe=(t,i)=>i.roomNumber;function ge(t,i){t&1&&(l(0,"p",13),m(1),c(2,"translate"),s()),t&2&&(r(),f(p(2,1,"LIST.reservation")))}function Ce(t,i){if(t&1&&(l(0,"span",11)(1,"p",12),m(2),c(3,"translate"),s(),g(4,ge,3,3,"p",13),s()),t&2){let n=i.$implicit;r(),h("ngClass",n.roomNumber===666?"hell":""),r(),S("",p(3,4,"LIST.room-number")," ",n.roomNumber,""),r(2),b(n.booked?4:-1)}}function we(t,i){if(t&1){let n=C();l(0,"button",15),x("click",function(){u(n);let e=d(2);return _(e.cancel())}),m(1),c(2,"translate"),s(),l(3,"button",15),x("click",function(){u(n);let e=d(2);return _(e.book())}),m(4),c(5,"translate"),s()}t&2&&(r(),f(p(2,2,"LIST.cancel")),r(3),f(p(5,4,"LIST.reserve")))}function ke(t,i){if(t&1){let n=C();l(0,"button",15),x("click",function(){u(n);let e=d(2);return _(e.cancel())}),m(1),c(2,"translate"),s(),l(3,"button",15),x("click",function(){u(n);let e=d(2);return _(e.deleteReservation())}),m(4),c(5,"translate"),s()}t&2&&(r(),f(p(2,2,"LIST.cancel")),r(3),f(p(5,4,"LIST.delete-reservation")))}function ve(t,i){if(t&1&&(l(0,"p"),m(1),c(2,"translate"),s(),l(3,"span",14),g(4,we,6,6)(5,ke,6,6),s()),t&2){let n=d();r(),S("",p(2,3,"LIST.room-nr")," ",n.store.selectedRoom().roomNumber,""),r(3),b(n.store.rooms().data[n.store.selectedRoom().roomNumber-1].booked?5:4)}}function be(t,i){if(t&1&&(l(0,"p"),m(1),c(2,"translate"),s()),t&2){let n=i.$implicit;r(),S("",p(2,2,"LIST.room-nr")," ",n.roomNumber,"")}}var Xe=(()=>{let i=class i{constructor(){this.store=k(E),this.skip=0,this.allRooms=Array.from({length:1e4},(o,e)=>({roomNumber:e+1,booked:!1}))}ngOnInit(){this.getFirstRooms()}getFirstRooms(){this.skip=0;let o=this.allRooms.slice(this.skip,this.skip+50);this.store.setRooms({total:1e4,data:o})}fetchMoreRooms(){if(this.store.rooms().data.length===this.store.rooms().total)return;this.skip+=50;let o=this.allRooms.slice(this.skip,this.skip+50);this.store.patchRooms(o)}selectRoom(o){o&&this.store.patchSelectedRoom(o)}cancel(){this.store.patchSelectedRoom({roomNumber:0,booked:!1})}book(){let o=L({},this.store.rooms());o.data[this.store.selectedRoom().roomNumber-1].booked=!0,this.store.setRooms(o),this.cancel()}deleteReservation(){let o=L({},this.store.rooms());o.data[this.store.selectedRoom().roomNumber-1].booked=!1,this.store.setRooms(o),this.cancel()}};i.\u0275fac=function(e){return new(e||i)},i.\u0275cmp=v({type:i,selectors:[["psa-list-page"]],standalone:!0,features:[K([E]),T],decls:26,vars:18,consts:[[1,"h-full"],[1,"text-2xl","mb-4"],[1,"flex","flex-col","gap-4"],[1,"divider"],[1,"ml-2","text-lg",3,"innerHTML"],[1,"flex","flex-col","sm:flex-row","gap-8"],[1,"psa-list"],[3,"fetchMore","selected","data","itemHeight"],["listItemTemplate",""],[1,"flex","flex-col","gap-8","w-48"],[1,"mb-4"],[1,"flex","flex-row","justify-between","items-center"],[3,"ngClass"],[1,"booked"],[1,"flex","flex-row","gap-4"],["mat-button","",3,"click"]],template:function(e,a){e&1&&(l(0,"psa-card",0)(1,"h1",1),m(2),c(3,"translate"),s(),l(4,"div",2)(5,"p"),m(6),c(7,"translate"),s(),j(8,"div",3)(9,"p",4),c(10,"translate"),l(11,"div",5)(12,"div",6)(13,"psa-list",7),x("fetchMore",function(){return a.fetchMoreRooms()})("selected",function(de){return a.selectRoom(de)}),g(14,Ce,5,6,"ng-template",8),s()(),l(15,"div",9)(16,"p"),m(17),c(18,"translate"),s(),g(19,ve,6,5),s(),l(20,"div")(21,"p",10),m(22),c(23,"translate"),s(),A(24,be,3,4,"p",null,xe),s()()()()),e&2&&(r(2),f(p(3,8,"LIST.header")),r(4),f(p(7,10,"LIST.component-desc")),r(3),h("innerHTML",p(10,12,"LIST.hello"),H),r(4),h("data",a.store.rooms().data)("itemHeight",88),r(4),f(p(18,14,"LIST.selected-room")),r(2),b(a.store.selectedRoom().roomNumber>0?19:-1),r(3),f(p(23,16,"LIST.your-reservations")),r(2),U(a.store.bookedRooms()))},dependencies:[ie,me,w,ee,y,te],styles:[".psa-list[_ngcontent-%COMP%]{height:555px;width:300px}.hell[_ngcontent-%COMP%]{color:red}.divider[_ngcontent-%COMP%]{height:1px;background-color:#818181}.booked[_ngcontent-%COMP%]{font-size:12px;color:#0dd}"],changeDetection:0});let t=i;return t})();export{Xe as ListPageComponent};
