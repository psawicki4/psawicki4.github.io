import"./chunk-M5MXGHIA.js";import{b as ie,f as oe,g as ne}from"./chunk-6ITMTARZ.js";import{a as y,b as re,c as ae,d as se,e as le}from"./chunk-BVTQBWYL.js";import"./chunk-4VCXD5SM.js";import{a as te}from"./chunk-TTYKCCQL.js";import{Ac as K,Bb as A,Bc as W,Cb as Q,D as B,Db as h,E as O,Eb as l,Fb as s,Jd as Z,Mb as z,Nb as g,Oc as T,Pb as x,Pc as X,Qb as d,R as D,Rd as ee,Xa as a,Xb as U,Xc as Y,Yb as j,Zb as V,_a as F,a as L,cc as c,dc as u,ea as v,fc as I,hb as w,ja as _,jb as H,ka as f,kc as q,mb as b,mc as G,nc as m,oc as p,u as P,uc as J,wb as $,xb as k,yb as S,yc as M,zc as E}from"./chunk-P4KAAWSZ.js";var C=(()=>{let o=class o{constructor(){this.templateRef=v(F)}};o.\u0275fac=function(e){return new(e||o)},o.\u0275dir=H({type:o,selectors:[["","listItemTemplate",""]]});let i=o;return i})();var de=["viewport"],ue=i=>({$implicit:i});function _e(i,o){if(i&1){let n=g();l(0,"li",4),x("click",function(){let e=_(n).$implicit,r=d();return f(r.selectItem(e))})("keyup.enter",function(){let e=_(n).$implicit,r=d();return f(r.selectItem(e))})("keydown.arrowDown",function(){let e=_(n).index,r=d();return f(r.changeFocus(e+1))})("keydown.arrowUp",function(){let e=_(n).index,r=d();return f(r.changeFocus(e-1))}),z(1,5),s()}if(i&2){let n=o.$implicit,t=o.index,e=d();h("id",t)("ngClass",e.selectedItem===n?"card__selected":"card")("tabindex",e.focusableIndex===t?0:-1),$("aria-selected",e.selectedItem===n?"true":"false"),a(),h("ngTemplateOutlet",e.listItemTemplateRef().templateRef)("ngTemplateOutletContext",G(6,ue,n))}}var me=(()=>{let o=class o{constructor(){this.focusableIndex=0,this.data=E([]),this.itemHeight=E(0),this.fetchMore=M(),this.selected=M(),this.listItemTemplateRef=W(C),this.viewport=K.required("viewport")}ngAfterViewInit(){this.subscription=this.viewport().elementScrolled().pipe(P(()=>this.viewport().measureScrollOffset("bottom")),D(),B(([t,e])=>e<t&&e<this.itemHeight()*2),O(50)).subscribe(()=>{this.fetchMore.emit()})}selectItem(t){this.selectedItem=t,this.selected.emit(t)}changeFocus(t){let e=document.getElementById(t.toString());e&&(e.focus(),this.focusableIndex=t)}trackBy(t){return t}ngOnDestroy(){this.subscription?.unsubscribe()}};o.\u0275fac=function(e){return new(e||o)},o.\u0275cmp=w({type:o,selectors:[["psa-list"]],contentQueries:function(e,r,R){e&1&&U(R,r.listItemTemplateRef,C,5),e&2&&V()},viewQuery:function(e,r){e&1&&j(r.viewport,de,5),e&2&&V()},inputs:{data:[1,"data"],itemHeight:[1,"itemHeight"]},outputs:{fetchMore:"fetchMore",selected:"selected"},decls:4,vars:3,consts:[["viewport",""],[1,"list",3,"itemSize"],["role","listbox"],["role","option","aria-selected","false","matRipple","",3,"id","ngClass","tabindex","click","keyup.enter","keydown.arrowDown","keydown.arrowUp",4,"cdkVirtualFor","cdkVirtualForOf","cdkVirtualForTrackBy"],["role","option","aria-selected","false","matRipple","",3,"click","keyup.enter","keydown.arrowDown","keydown.arrowUp","id","ngClass","tabindex"],[3,"ngTemplateOutlet","ngTemplateOutletContext"]],template:function(e,r){e&1&&(l(0,"cdk-virtual-scroll-viewport",1,0)(2,"ul",2),b(3,_e,2,8,"li",3),s()()),e&2&&(h("itemSize",r.itemHeight()),a(3),h("cdkVirtualForOf",r.data())("cdkVirtualForTrackBy",r.trackBy))},dependencies:[oe,ie,ne,T,X,Z],styles:['@font-face{font-family:Open Sans fallback;src:local("Arial");ascent-override:106.8847656%;descent-override:29.296875%;line-gap-override:0%}.list[_ngcontent-%COMP%]{width:100%;height:100%;display:flex;flex-direction:column;gap:8px;scrollbar-width:thin}.card[_ngcontent-%COMP%], .card__selected[_ngcontent-%COMP%]{padding:24px 32px;border-radius:4px;border-right:solid 1px rgba(255,255,255,.12);background-color:#282828;margin:8px;cursor:pointer}.card__selected[_ngcontent-%COMP%]{background-color:#393939}'],changeDetection:0});let i=o;return i})();var fe={rooms:{total:0,data:[]},selectedRoom:{roomNumber:0,booked:!1}},N=re(le(fe),ae(({rooms:i})=>({bookedRooms:J(()=>i().data.filter(o=>o.booked))})),se(i=>({setRooms(o){y(i,{rooms:o})},patchRooms(o){y(i,n=>({rooms:{total:1e4,data:[...n.rooms.data,...o]}}))},patchSelectedRoom(o){y(i,{selectedRoom:o})}})));var he=(i,o)=>o.roomNumber;function xe(i,o){i&1&&(l(0,"p",12),c(1),m(2,"translate"),s()),i&2&&(a(),u(p(2,1,"LIST.reservation")))}function ge(i,o){if(i&1&&(l(0,"span",10)(1,"p",11),c(2),m(3,"translate"),s(),k(4,xe,3,3,"p",12),s()),i&2){let n=o.$implicit;a(),h("ngClass",n.roomNumber===666?"hell":""),a(),I("",p(3,4,"LIST.room-number")," ",n.roomNumber),a(2),S(n.booked?4:-1)}}function Ce(i,o){if(i&1){let n=g();l(0,"button",14),x("click",function(){_(n);let e=d(2);return f(e.cancel())}),c(1),m(2,"translate"),s(),l(3,"button",14),x("click",function(){_(n);let e=d(2);return f(e.book())}),c(4),m(5,"translate"),s()}i&2&&(a(),u(p(2,2,"LIST.cancel")),a(3),u(p(5,4,"LIST.reserve")))}function ve(i,o){if(i&1){let n=g();l(0,"button",14),x("click",function(){_(n);let e=d(2);return f(e.cancel())}),c(1),m(2,"translate"),s(),l(3,"button",14),x("click",function(){_(n);let e=d(2);return f(e.deleteReservation())}),c(4),m(5,"translate"),s()}i&2&&(a(),u(p(2,2,"LIST.cancel")),a(3),u(p(5,4,"LIST.delete-reservation")))}function we(i,o){if(i&1&&(l(0,"p"),c(1),m(2,"translate"),s(),l(3,"span",13),k(4,Ce,6,6)(5,ve,6,6),s()),i&2){let n=d();a(),I("",p(2,3,"LIST.room-nr")," ",n.store.selectedRoom().roomNumber),a(3),S(n.store.selectedRoom().booked?5:4)}}function be(i,o){if(i&1&&(l(0,"p"),c(1),m(2,"translate"),s()),i&2){let n=o.$implicit;a(),I("",p(2,2,"LIST.room-nr")," ",n.roomNumber)}}var Je=(()=>{let o=class o{constructor(){this.store=v(N),this.skip=0,this.allRooms=Array.from({length:1e4},(t,e)=>({roomNumber:e+1,booked:!1})).filter(t=>t.roomNumber!==404)}ngOnInit(){this.getFirstRooms()}getFirstRooms(){this.skip=0;let t=this.allRooms.slice(this.skip,this.skip+50);this.store.setRooms({total:9999,data:t})}fetchMoreRooms(){if(this.store.rooms().data.length===this.store.rooms().total)return;this.skip+=50;let t=this.allRooms.slice(this.skip,this.skip+50);this.store.patchRooms(t)}selectRoom(t){t&&this.store.patchSelectedRoom(t)}cancel(){this.store.patchSelectedRoom({roomNumber:0,booked:!1})}book(){let t=L({},this.store.rooms());console.log(this.store.selectedRoom().roomNumber);let e=t.data.findIndex(r=>r.roomNumber===this.store.selectedRoom().roomNumber);e!==-1&&(t.data[e].booked=!0),this.store.setRooms(t),this.cancel()}deleteReservation(){let t=L({},this.store.rooms()),e=t.data.findIndex(r=>r.roomNumber===this.store.selectedRoom().roomNumber);e!==-1&&(t.data[e].booked=!1),this.store.setRooms(t),this.cancel()}};o.\u0275fac=function(e){return new(e||o)},o.\u0275cmp=w({type:o,selectors:[["psa-list-page"]],features:[q([N])],decls:26,vars:18,consts:[[1,"text-2xl","mb-4"],[1,"flex","flex-col","gap-4","items-center"],[1,"mb-4"],[1,"text-lg"],[1,"flex","flex-col","md:flex-row","gap-16"],[1,"psa-list"],[3,"fetchMore","selected","data","itemHeight"],["listItemTemplate",""],[1,"flex","flex-col","gap-8","w-72"],[1,"w-72"],[1,"flex","flex-row","justify-between","items-center"],[3,"ngClass"],[1,"booked"],[1,"flex","flex-row","gap-4"],["matButton","",3,"click"]],template:function(e,r){e&1&&(l(0,"psa-card")(1,"h1",0),c(2),m(3,"translate"),s(),l(4,"div",1)(5,"p",2),c(6),m(7,"translate"),s(),l(8,"p",3),c(9),m(10,"translate"),s(),l(11,"div",4)(12,"div",5)(13,"psa-list",6),x("fetchMore",function(){return r.fetchMoreRooms()})("selected",function(pe){return r.selectRoom(pe)}),b(14,ge,5,6,"ng-template",7),s()(),l(15,"div",8)(16,"p"),c(17),m(18,"translate"),s(),k(19,we,6,5),s(),l(20,"div",9)(21,"p",2),c(22),m(23,"translate"),s(),A(24,be,3,4,"p",null,he),s()()()()),e&2&&(a(2),u(p(3,8,"LIST.header")),a(4),u(p(7,10,"LIST.component-desc")),a(3),u(p(10,12,"LIST.hello")),a(4),h("data",r.store.rooms().data)("itemHeight",72),a(4),u(p(18,14,"LIST.selected-room")),a(2),S(r.store.selectedRoom().roomNumber>0?19:-1),a(3),u(p(23,16,"LIST.your-reservations")),a(2),Q(r.store.bookedRooms()))},dependencies:[te,me,C,T,ee,Y],styles:['@font-face{font-family:Open Sans fallback;src:local("Arial");ascent-override:106.8847656%;descent-override:29.296875%;line-gap-override:0%}.psa-list[_ngcontent-%COMP%]{height:515px;width:300px}.hell[_ngcontent-%COMP%]{color:red}.booked[_ngcontent-%COMP%]{font-size:12px;color:#0dd}'],changeDetection:0});let i=o;return i})();export{Je as ListPageComponent};
