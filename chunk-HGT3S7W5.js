import{b as te,f as ie,g as oe}from"./chunk-B7PUBXMZ.js";import{a as I,b as ne,c as re,d as ae,e as se}from"./chunk-ZA3SO4OS.js";import{a as ee}from"./chunk-O6MCBMP7.js";import{$ as Y,Q as X,ba as Z}from"./chunk-NSY6YMD5.js";import{h as S,i as W}from"./chunk-FJJLFHZV.js";import{Ab as g,D as E,Fa as L,Fc as K,Ga as R,Gb as h,Kb as b,Nb as Q,Ob as z,Pb as s,Qb as r,R as B,Rb as A,Ub as U,Vb as C,Yb as x,_ as O,_b as m,a as y,cb as D,fb as n,gc as j,ha as v,hc as q,ib as F,ic as V,kc as p,lc as f,nc as T,ob as N,pb as H,ra as _,rc as G,sa as u,tb as k,tc as J,u as P,uc as l,vb as $,vc as c}from"./chunk-3QQVATQK.js";var w=(()=>{class t{constructor(){this.templateRef=v(F)}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275dir=$({type:t,selectors:[["","listItemTemplate",""]]})}}return t})();var me=["viewport"],de=t=>({$implicit:t});function _e(t,a){if(t&1){let e=C();s(0,"li",4),x("click",function(){let o=_(e).$implicit,d=m();return u(d.selectItem(o))})("keyup.enter",function(){let o=_(e).$implicit,d=m();return u(d.selectItem(o))})("keydown.arrowDown",function(){let o=_(e).index,d=m();return u(d.changeFocus(o+1))})("keydown.arrowUp",function(){let o=_(e).index,d=m();return u(d.changeFocus(o-1))}),U(1,5),r()}if(t&2){let e=a.$implicit,i=a.index,o=m();h("id",i)("ngClass",o.selectedItem===e?"card__selected":"card")("tabindex",o.focusableIndex===i?0:-1),n(),h("ngTemplateOutlet",o.listItemTemplateRef().templateRef)("ngTemplateOutletContext",J(5,de,e))}}var ce=(()=>{class t{constructor(){this.focusableIndex=0,this.data=R([]),this.itemHeight=R(0),this.fetchMore=L(),this.selected=L(),this.listItemTemplateRef=H(w),this.viewport=N.required("viewport")}ngAfterViewInit(){this.subscription=this.viewport().elementScrolled().pipe(P(()=>this.viewport().measureScrollOffset("bottom")),B(),E(([e,i])=>i<e&&i<this.itemHeight()*2),O(50)).subscribe(()=>{this.fetchMore.emit()})}selectItem(e){this.selectedItem=e,this.selected.emit(e)}changeFocus(e){let i=document.getElementById(e.toString());i&&(i.focus(),this.focusableIndex=e)}trackBy(e){return e}ngOnDestroy(){this.subscription?.unsubscribe()}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275cmp=k({type:t,selectors:[["psa-list"]],contentQueries:function(i,o,d){i&1&&j(d,o.listItemTemplateRef,w,5),i&2&&V()},viewQuery:function(i,o){i&1&&q(o.viewport,me,5),i&2&&V()},inputs:{data:[1,"data"],itemHeight:[1,"itemHeight"]},outputs:{fetchMore:"fetchMore",selected:"selected"},decls:4,vars:3,consts:[["viewport",""],[1,"list",3,"itemSize"],["role","listbox"],["role","option","matRipple","",3,"id","ngClass","tabindex","click","keyup.enter","keydown.arrowDown","keydown.arrowUp",4,"cdkVirtualFor","cdkVirtualForOf","cdkVirtualForTrackBy"],["role","option","matRipple","",3,"click","keyup.enter","keydown.arrowDown","keydown.arrowUp","id","ngClass","tabindex"],[3,"ngTemplateOutlet","ngTemplateOutletContext"]],template:function(i,o){i&1&&(s(0,"cdk-virtual-scroll-viewport",1,0)(2,"ul",2),g(3,_e,2,7,"li",3),r()()),i&2&&(h("itemSize",o.itemHeight()),n(3),h("cdkVirtualForOf",o.data())("cdkVirtualForTrackBy",o.trackBy))},dependencies:[ie,te,oe,S,W,X],styles:[".list[_ngcontent-%COMP%]{width:100%;height:100%;display:flex;flex-direction:column;gap:8px;scrollbar-width:thin}.card[_ngcontent-%COMP%], .card__selected[_ngcontent-%COMP%]{padding:32px;border-radius:4px;border-right:solid 1px rgba(255,255,255,.12);background-color:#282828;margin:8px;cursor:pointer}.card__selected[_ngcontent-%COMP%]{background-color:#343434}"],changeDetection:0})}}return t})();var ue={rooms:{total:0,data:[]},selectedRoom:{roomNumber:0,booked:!1}},M=ne(se(ue),re(({rooms:t})=>({bookedRooms:K(()=>t().data.filter(a=>a.booked))})),ae(t=>({setRooms(a){I(t,{rooms:a})},patchRooms(a){I(t,e=>({rooms:{total:1e4,data:[...e.rooms.data,...a]}}))},patchSelectedRoom(a){I(t,{selectedRoom:a})}})));var fe=(t,a)=>a.roomNumber;function he(t,a){t&1&&(s(0,"p",13),p(1),l(2,"translate"),r()),t&2&&(n(),f(c(2,1,"LIST.reservation")))}function xe(t,a){if(t&1&&(s(0,"span",11)(1,"p",12),p(2),l(3,"translate"),r(),g(4,he,3,3,"p",13),r()),t&2){let e=a.$implicit;n(),h("ngClass",e.roomNumber===666?"hell":""),n(),T("",c(3,4,"LIST.room-number")," ",e.roomNumber,""),n(2),b(e.booked?4:-1)}}function ge(t,a){if(t&1){let e=C();s(0,"button",15),x("click",function(){_(e);let o=m(2);return u(o.cancel())}),p(1),l(2,"translate"),r(),s(3,"button",15),x("click",function(){_(e);let o=m(2);return u(o.book())}),p(4),l(5,"translate"),r()}t&2&&(n(),f(c(2,2,"LIST.cancel")),n(3),f(c(5,4,"LIST.reserve")))}function Ce(t,a){if(t&1){let e=C();s(0,"button",15),x("click",function(){_(e);let o=m(2);return u(o.cancel())}),p(1),l(2,"translate"),r(),s(3,"button",15),x("click",function(){_(e);let o=m(2);return u(o.deleteReservation())}),p(4),l(5,"translate"),r()}t&2&&(n(),f(c(2,2,"LIST.cancel")),n(3),f(c(5,4,"LIST.delete-reservation")))}function we(t,a){if(t&1&&(s(0,"p"),p(1),l(2,"translate"),r(),s(3,"span",14),g(4,ge,6,6)(5,Ce,6,6),r()),t&2){let e=m();n(),T("",c(2,3,"LIST.room-nr")," ",e.store.selectedRoom().roomNumber,""),n(3),b(e.store.rooms().data[e.store.selectedRoom().roomNumber-1].booked?5:4)}}function ve(t,a){if(t&1&&(s(0,"p"),p(1),l(2,"translate"),r()),t&2){let e=a.$implicit;n(),T("",c(2,2,"LIST.room-nr")," ",e.roomNumber,"")}}var Ge=(()=>{class t{constructor(){this.store=v(M),this.skip=0,this.allRooms=Array.from({length:1e4},(e,i)=>({roomNumber:i+1,booked:!1}))}ngOnInit(){this.getFirstRooms()}getFirstRooms(){this.skip=0;let e=this.allRooms.slice(this.skip,this.skip+50);this.store.setRooms({total:1e4,data:e})}fetchMoreRooms(){if(this.store.rooms().data.length===this.store.rooms().total)return;this.skip+=50;let e=this.allRooms.slice(this.skip,this.skip+50);this.store.patchRooms(e)}selectRoom(e){e&&this.store.patchSelectedRoom(e)}cancel(){this.store.patchSelectedRoom({roomNumber:0,booked:!1})}book(){let e=y({},this.store.rooms());e.data[this.store.selectedRoom().roomNumber-1].booked=!0,this.store.setRooms(e),this.cancel()}deleteReservation(){let e=y({},this.store.rooms());e.data[this.store.selectedRoom().roomNumber-1].booked=!1,this.store.setRooms(e),this.cancel()}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275cmp=k({type:t,selectors:[["psa-list-page"]],features:[G([M])],decls:26,vars:18,consts:[[1,"h-full"],[1,"text-2xl","mb-4"],[1,"flex","flex-col","gap-4"],[1,"divider"],[1,"ml-2","text-lg",3,"innerHTML"],[1,"flex","flex-col","sm:flex-row","gap-8"],[1,"psa-list"],[3,"fetchMore","selected","data","itemHeight"],["listItemTemplate",""],[1,"flex","flex-col","gap-8","w-48"],[1,"mb-4"],[1,"flex","flex-row","justify-between","items-center"],[3,"ngClass"],[1,"booked"],[1,"flex","flex-row","gap-4"],["mat-button","",3,"click"]],template:function(i,o){i&1&&(s(0,"psa-card",0)(1,"h1",1),p(2),l(3,"translate"),r(),s(4,"div",2)(5,"p"),p(6),l(7,"translate"),r(),A(8,"div",3)(9,"p",4),l(10,"translate"),s(11,"div",5)(12,"div",6)(13,"psa-list",7),x("fetchMore",function(){return o.fetchMoreRooms()})("selected",function(pe){return o.selectRoom(pe)}),g(14,xe,5,6,"ng-template",8),r()(),s(15,"div",9)(16,"p"),p(17),l(18,"translate"),r(),g(19,we,6,5),r(),s(20,"div")(21,"p",10),p(22),l(23,"translate"),r(),Q(24,ve,3,4,"p",null,fe),r()()()()),i&2&&(n(2),f(c(3,8,"LIST.header")),n(4),f(c(7,10,"LIST.component-desc")),n(3),h("innerHTML",c(10,12,"LIST.hello"),D),n(4),h("data",o.store.rooms().data)("itemHeight",88),n(4),f(c(18,14,"LIST.selected-room")),n(2),b(o.store.selectedRoom().roomNumber>0?19:-1),n(3),f(c(23,16,"LIST.your-reservations")),n(2),z(o.store.bookedRooms()))},dependencies:[ee,ce,w,Y,S,Z],styles:[".psa-list[_ngcontent-%COMP%]{height:555px;width:300px}.hell[_ngcontent-%COMP%]{color:red}.divider[_ngcontent-%COMP%]{height:1px;background-color:#818181}.booked[_ngcontent-%COMP%]{font-size:12px;color:#0dd}"],changeDetection:0})}}return t})();export{Ge as ListPageComponent};
