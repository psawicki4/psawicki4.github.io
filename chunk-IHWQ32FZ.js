import{a as oe,e as ne,f as re}from"./chunk-D72X7CZZ.js";import{a as Y}from"./chunk-YELY4PQJ.js";import{M as Z,_ as ee,da as te,ea as ie}from"./chunk-CHOH6AKT.js";import{h as T,i as X}from"./chunk-6WSPWO2O.js";import{Ab as g,Cb as h,D as E,Ga as S,Gb as b,Gc as W,Ha as L,Jb as z,Kb as A,Lb as s,Mb as l,Nb as U,Qb as j,R as F,Rb as C,Ub as x,Wb as d,_ as O,a as I,ab as N,cc as q,db as r,dc as G,ec as V,gb as H,gc as c,ha as B,hc as f,ic as J,jc as M,ma as w,oa as D,oc as v,qc as K,rc as p,sb as R,sc as m,tb as $,u as P,ub as Q,xa as u,ya as _}from"./chunk-QHYXH3OY.js";var k=(()=>{let o=class o{constructor(){this.templateRef=B(H)}};o.\u0275fac=function(e){return new(e||o)},o.\u0275dir=D({type:o,selectors:[["","listItemTemplate",""]],standalone:!0});let i=o;return i})();var ce=["viewport"],pe=i=>({$implicit:i});function me(i,o){if(i&1){let n=C();s(0,"li",4),x("click",function(){let e=u(n).$implicit,a=d();return _(a.selectItem(e))})("keyup.enter",function(){let e=u(n).$implicit,a=d();return _(a.selectItem(e))})("keydown.arrowDown",function(){let e=u(n).index,a=d();return _(a.changeFocus(e+1))})("keydown.arrowUp",function(){let e=u(n).index,a=d();return _(a.changeFocus(e-1))}),j(1,5),l()}if(i&2){let n=o.$implicit,t=o.index,e=d();h("id",t)("ngClass",e.selectedItem===n?"card__selected":"card")("tabindex",e.focusableIndex===t?0:-1),r(),h("ngTemplateOutlet",e.listItemTemplateRef().templateRef)("ngTemplateOutletContext",K(5,pe,n))}}var le=(()=>{let o=class o{constructor(){this.focusableIndex=0,this.data=L([]),this.itemHeight=L(0),this.fetchMore=S(),this.selected=S(),this.listItemTemplateRef=Q(k),this.viewport=$.required("viewport")}ngAfterViewInit(){this.subscription=this.viewport().elementScrolled().pipe(P(()=>this.viewport().measureScrollOffset("bottom")),F(),E(([t,e])=>e<t&&e<this.itemHeight()*2),O(50)).subscribe(()=>{console.log("tick"),this.fetchMore.emit()})}selectItem(t){this.selectedItem=t,this.selected.emit(t)}changeFocus(t){let e=document.getElementById(t.toString());e&&(e.focus(),this.focusableIndex=t)}trackBy(t){return t}ngOnDestroy(){this.subscription?.unsubscribe()}};o.\u0275fac=function(e){return new(e||o)},o.\u0275cmp=w({type:o,selectors:[["psa-list"]],contentQueries:function(e,a,y){e&1&&q(y,a.listItemTemplateRef,k,5),e&2&&V()},viewQuery:function(e,a){e&1&&G(a.viewport,ce,5),e&2&&V()},inputs:{data:[1,"data"],itemHeight:[1,"itemHeight"]},outputs:{fetchMore:"fetchMore",selected:"selected"},standalone:!0,features:[v],decls:4,vars:3,consts:[["viewport",""],[1,"list",3,"itemSize"],["role","listbox"],["role","option","matRipple","",3,"id","ngClass","tabindex","click","keyup.enter","keydown.arrowDown","keydown.arrowUp",4,"cdkVirtualFor","cdkVirtualForOf","cdkVirtualForTrackBy"],["role","option","matRipple","",3,"click","keyup.enter","keydown.arrowDown","keydown.arrowUp","id","ngClass","tabindex"],[3,"ngTemplateOutlet","ngTemplateOutletContext"]],template:function(e,a){e&1&&(s(0,"cdk-virtual-scroll-viewport",1,0)(2,"ul",2),g(3,me,2,7,"li",3),l()()),e&2&&(h("itemSize",a.itemHeight()),r(3),h("cdkVirtualForOf",a.data())("cdkVirtualForTrackBy",a.trackBy))},dependencies:[ne,oe,re,T,X,Z],styles:[".list[_ngcontent-%COMP%]{width:100%;height:100%;display:flex;flex-direction:column;gap:8px;scrollbar-width:thin}.card[_ngcontent-%COMP%], .card__selected[_ngcontent-%COMP%]{padding:32px;border-radius:4px;border-right:solid 1px rgba(255,255,255,.12);background-color:#282828;margin:8px;cursor:pointer}.card__selected[_ngcontent-%COMP%]{background-color:#343434}"],changeDetection:0});let i=o;return i})();var de=(i,o)=>o.roomNumber;function ue(i,o){i&1&&(s(0,"p",12),c(1),p(2,"translate"),l()),i&2&&(r(),f(m(2,1,"LIST.booked")))}function _e(i,o){if(i&1&&(s(0,"span",10)(1,"p",11),c(2),p(3,"translate"),l(),g(4,ue,3,3,"p",12),l()),i&2){let n=o.$implicit;r(),h("ngClass",n.roomNumber===666?"hell":""),r(),M("",m(3,4,"LIST.room-number")," ",n.roomNumber,""),r(2),b(n.booked?4:-1)}}function fe(i,o){if(i&1){let n=C();s(0,"button",14),x("click",function(){u(n);let e=d(2);return _(e.cancel())}),c(1),p(2,"translate"),l(),s(3,"button",15),x("click",function(){u(n);let e=d(2);return _(e.book())}),c(4),p(5,"translate"),l()}i&2&&(r(),f(m(2,2,"LIST.cancel")),r(3),f(m(5,4,"LIST.book")))}function he(i,o){if(i&1){let n=C();s(0,"button",14),x("click",function(){u(n);let e=d(2);return _(e.cancel())}),c(1),p(2,"translate"),l(),s(3,"button",15),x("click",function(){u(n);let e=d(2);return _(e.deleteReservation())}),c(4),p(5,"translate"),l()}i&2&&(r(),f(m(2,2,"LIST.cancel")),r(3),f(m(5,4,"LIST.delete-reservation")))}function xe(i,o){if(i&1&&(s(0,"p"),c(1),l(),s(2,"span",13),g(3,fe,6,6)(4,he,6,6),l()),i&2){let n=d();r(),J("Pok\xF3j nr. ",n.selectedRoom().roomNumber,""),r(2),b(n.rooms().data[n.selectedRoom().roomNumber-1].booked?4:3)}}function ge(i,o){if(i&1&&(s(0,"p"),c(1),p(2,"translate"),l()),i&2){let n=o.$implicit;r(),M("",m(2,2,"LIST.room-nr")," ",n.roomNumber,"")}}var Ae=(()=>{let o=class o{constructor(){this.rooms=R({total:0,data:[]}),this.bookedRooms=W(()=>this.rooms().data.filter(t=>t.booked)),this.selectedRoom=R({roomNumber:0,booked:!1}),this.skip=0,this.allRooms=Array.from({length:1e4},(t,e)=>({roomNumber:e+1,booked:!1}))}ngOnInit(){this.getFirstRooms()}getFirstRooms(){this.skip=0;let t=this.allRooms.slice(this.skip,this.skip+50);this.rooms.set({total:1e4,data:t})}fetchMoreRooms(){if(this.rooms().data.length===this.rooms().total)return;this.skip+=50;let t=this.allRooms.slice(this.skip,this.skip+50),e={total:1e4,data:[...this.rooms().data,...t]};this.rooms.set(e)}selectRoom(t){t&&this.selectedRoom.set(t)}cancel(){this.selectedRoom.set({roomNumber:0,booked:!1})}book(){let t=I({},this.rooms());t.data[this.selectedRoom()?.roomNumber-1].booked=!0,this.rooms.set(t),this.cancel()}deleteReservation(){let t=I({},this.rooms());t.data[this.selectedRoom()?.roomNumber-1].booked=!1,this.rooms.set(t),this.cancel()}};o.\u0275fac=function(e){return new(e||o)},o.\u0275cmp=w({type:o,selectors:[["psa-list-page"]],standalone:!0,features:[v],decls:26,vars:18,consts:[[1,"text-2xl","mb-4"],[1,"flex","flex-col","gap-4"],[1,"divider"],[1,"ml-2",3,"innerHTML"],[1,"flex","flex-row","gap-8"],[1,"psa-list"],[3,"fetchMore","selected","data","itemHeight"],["listItemTemplate",""],[1,"flex","flex-col","gap-8","w-48"],[1,"mb-4"],[1,"flex","flex-row","justify-between","items-center"],[3,"ngClass"],[1,"booked"],[1,"flex","flex-row","self-end","gap-4"],["mat-button","",3,"click"],["mat-flat-button","",3,"click"]],template:function(e,a){e&1&&(s(0,"psa-card")(1,"h1",0),c(2),p(3,"translate"),l(),s(4,"div",1)(5,"p"),c(6),p(7,"translate"),l(),U(8,"div",2)(9,"p",3),p(10,"translate"),s(11,"div",4)(12,"div",5)(13,"psa-list",6),x("fetchMore",function(){return a.fetchMoreRooms()})("selected",function(se){return a.selectRoom(se)}),g(14,_e,5,6,"ng-template",7),l()(),s(15,"div",8)(16,"p"),c(17),p(18,"translate"),l(),g(19,xe,5,2),l(),s(20,"div")(21,"p",9),c(22),p(23,"translate"),l(),z(24,ge,3,4,"p",null,de),l()()()()),e&2&&(r(2),f(m(3,8,"LIST.header")),r(4),f(m(7,10,"LIST.component-desc")),r(3),h("innerHTML",m(10,12,"LIST.hello"),N),r(4),h("data",a.rooms().data)("itemHeight",88),r(4),f(m(18,14,"LIST.selected-room")),r(2),b(a.selectedRoom().roomNumber>0?19:-1),r(3),f(m(23,16,"LIST.your-reservations")),r(2),A(a.bookedRooms()))},dependencies:[Y,le,k,ie,te,T,ee],styles:[".psa-list[_ngcontent-%COMP%]{height:580px;width:300px}.hell[_ngcontent-%COMP%]{color:red}.divider[_ngcontent-%COMP%]{height:1px;background-color:#818181}.booked[_ngcontent-%COMP%]{font-size:12px;color:#0dd}"],changeDetection:0});let i=o;return i})();export{Ae as ListPageComponent};
